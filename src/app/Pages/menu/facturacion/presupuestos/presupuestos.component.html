<div>

  <!-- üîç buscador -->
  <div class="search-menu">
    <div class="icon-menu">
      <mat-icon (click)="openMenu()">menu</mat-icon>
    </div>

    <div class="input-wrapper">
      <mat-icon class="input-icon">search</mat-icon>
      <input [(ngModel)]="filtroTexto" type="text" placeholder="Buscar por C√≥digo..." class="input" />
    </div>
  </div>

  <!-- ‚úÖ Header -->
  <div class="header-secuence">
    <div style="display: flex; flex-direction: column; gap: 0.4rem;">
      <div class="selected">Presupuestos del Internamiento</div>
      <div class="subTitle">
        Internamiento #{{ intakeId }}
      </div>
    </div>

    <div>
      <button class="btn btn-create" (click)="openCreateBudgetModal()">
        <mat-icon>add</mat-icon> Nuevo Presupuesto
      </button>
    </div>
  </div>

  <!-- ‚úÖ Cards -->
  <div class="container-card">
    <div class="card">
      <div class="card-title">Total Presupuestos</div>
      <div class="card-value">{{ budgets.length }}</div>
      <div class="footer-card">Hist√≥rico completo</div>
    </div>

    <div class="card">
      <div class="card-title">Oficial</div>
      <div class="card-value">{{ getOfficialCode() }}</div>
      <div class="footer-card">Aprobado por cliente</div>
    </div>

    <div class="card">
      <div class="card-title">Pendientes</div>
      <div class="card-value">{{ countPending() }}</div>
      <div class="footer-card">Por aprobar</div>
    </div>
  </div>

  <!-- ‚úÖ Tabla -->
  <div class="table-container">
    <div class="table-actions">
      <div class="selected">Lista de Presupuestos</div>
    </div>

    <div class="table-scroll">
      <div class="table-body">
        <table class="custom-table">
          <thead>
            <tr>
              <th>C√≥digo</th>
              <th>Total</th>
              <th>Fecha</th>
              <th>Estado</th>
              <th>Oficial</th>
              <th>Ord. Trabajo</th>
            </tr>
          </thead>

          <tbody>
            <tr
              *ngFor="let b of budgets | budgetFilter:filtroTexto | slice:(paginaActual-1)*filasPorPagina:(paginaActual*filasPorPagina)"
              (click)="openBudgetDetail(b)" style="cursor:pointer;">
              <td><strong>{{ b.code }}</strong></td>

              <td>{{ b.total | currency:'PEN':'symbol':'1.2-2' }}</td>

              <td>{{ b.createdAt | date:'dd/MM/yyyy HH:mm' }}</td>

              <td>
                <span class="chip activo" *ngIf="b.isApproved">Aprobado</span>
                <span class="chip suspendido" *ngIf="!b.isApproved">Pendiente</span>
              </td>

              <td>
                <span class="chip multi" *ngIf="b.isOfficial">OFICIAL</span>
                <span *ngIf="!b.isOfficial" style="color:gray;">Hist√≥rico</span>
              </td>
              <td>
                <button class="btn btn-create" (click)="$event.stopPropagation(); generateWorkOrder()" [disabled]="!hasOfficialApprovedBudget()">
                  <mat-icon>build</mat-icon> Orden de Trabajo
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ‚úÖ paginaci√≥n -->
    <div class="pagination">
      <span>Filas por p√°gina: </span>

      <span>
        {{(paginaActual-1)*filasPorPagina+1}} -
        {{paginaActual*filasPorPagina > budgets.length ? budgets.length : paginaActual*filasPorPagina}}
        de {{budgets.length}}
      </span>

      <button class="paginacion-icon" (click)="paginaAnterior()" [disabled]="paginaActual===1">
        <mat-icon>chevron_left</mat-icon>
      </button>

      <button class="paginacion-icon" (click)="paginaSiguiente()"
        [disabled]="paginaActual*filasPorPagina>=budgets.length">
        <mat-icon>chevron_right</mat-icon>
      </button>
    </div>

  </div>

</div>