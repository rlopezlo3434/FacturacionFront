<div>

  <!-- ðŸ” buscador -->
  <div class="search-menu">
    <div class="icon-menu">
      <mat-icon (click)="openMenu()">menu</mat-icon>
    </div>

    <div class="input-wrapper">
      <mat-icon class="input-icon">search</mat-icon>
      <input [(ngModel)]="filtroTexto" type="text"
        placeholder="Buscar por CÃ³digo, Nombre, Serie o Marca..."
        class="input" />
    </div>
  </div>

  <!-- âœ… Header -->
  <div class="header-secuence">
    <div style="display: flex; flex-direction: column; gap: 0.4rem;">
      <div class="selected">GestiÃ³n de Productos</div>
      <div class="subTitle">Administra tu inventario de productos y repuestos</div>
    </div>

    <div>
      <button class="btn btn-create" (click)="openCreateDialog()">
        <mat-icon>add</mat-icon> Nuevo Producto
      </button>
    </div>
  </div>

  <!-- âœ… Cards -->
  <div class="container-card">
    <div class="card">
      <div class="card-title">Total Productos</div>
      <div class="card-value">{{ productos.length }}</div>
      <div class="footer-card">En inventario</div>
    </div>

    <div class="card">
      <div class="card-title">Stock Bajo</div>
      <div class="card-value">{{ countLowStock() }}</div>
      <div class="footer-card">Menor a {{ lowStockLimit }}</div>
    </div>

    <div class="card">
      <div class="card-title">Multi Marca</div>
      <div class="card-value">{{ countMultiBrand() }}</div>
      <div class="footer-card">Productos universales</div>
    </div>
  </div>

  <!-- âœ… Tabla -->
  <div class="table-container">
    <div class="table-actions">
      <div class="selected">Lista de Productos</div>
    </div>

    <div class="table-scroll">
      <div class="table-body">
        <table class="custom-table">
          <thead>
            <tr>
              <!-- <th>Id</th> -->
              <th>CÃ³digo</th>
              <th>Producto</th>
              <th>Cantidad</th>
              <th>Und. Medida</th>
              <th>Precio Costo</th>
              <th>Precio Venta</th>
              <th>CÃ³digo Serie</th>
              <th>Marca</th>
              <th>Multi Marca</th>
            </tr>
          </thead>

          <tbody>
            <tr
              *ngFor="let p of productos | productFilter:filtroTexto | slice:(paginaActual-1)*filasPorPagina:(paginaActual*filasPorPagina)"
              (click)="openEditDialog(p)"
              style="cursor:pointer;"
            >
              <!-- <td>{{ p.id }}</td> -->

              <td>
                <strong>{{ p.code }}</strong>
              </td>

              <td>{{ p.name }}</td>

              <td>
                <span [class.low-stock]="p.quantity <= lowStockLimit">
                  {{ p.quantity }}
                </span>
              </td>

              <td>{{ p.unitMeasure?.name || 'â€”' }}</td>
              <td>{{ p.cost | currency:'PEN':'symbol':'1.2-2' }}</td>
              <td>{{ p.price | currency:'PEN':'symbol':'1.2-2' }}


              <td>{{ p.serialCode || 'â€”' }}</td>

              <td>
                <span *ngIf="p.isMultiBrand" style="color:gray;">Todas</span>
                <span *ngIf="!p.isMultiBrand">{{ p.brand?.name || 'â€”' }}</span>
              </td>

              <td>
                <span class="chip multi" *ngIf="p.isMultiBrand">SÃ­</span>
                <span class="chip single" *ngIf="!p.isMultiBrand">No</span>
              </td>

            </tr>
          </tbody>

        </table>
      </div>
    </div>

    <!-- âœ… paginaciÃ³n -->
    <div class="pagination">
      <span>Filas por pÃ¡gina: </span>

      <span>
        {{(paginaActual-1)*filasPorPagina+1}} -
        {{paginaActual*filasPorPagina > productos.length ? productos.length : paginaActual*filasPorPagina}}
        de {{productos.length}}
      </span>

      <button class="paginacion-icon" (click)="paginaAnterior()" [disabled]="paginaActual===1">
        <mat-icon>chevron_left</mat-icon>
      </button>

      <button class="paginacion-icon" (click)="paginaSiguiente()"
        [disabled]="paginaActual*filasPorPagina>=productos.length">
        <mat-icon>chevron_right</mat-icon>
      </button>
    </div>

  </div>

</div>
